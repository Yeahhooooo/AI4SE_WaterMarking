# 水印应用产品需求文档 (PRD)

## 1. 项目概述

### 1.1 项目目标
开发一款本地桌面应用，允许用户方便地为单张或批量图片添加文本或图片水印。应用需支持主流操作系统（优先支持 macOS），并提供丰富的自定义选项和配置管理功能，最终打包为可直接运行的执行文件。

### 1.2 目标用户
- 摄影师、设计师等需要保护作品版权的创作者。
- 社交媒体运营者、博主等需要在图片上添加品牌标识的用户。
- 普通用户，有在图片上添加个性化文字或标记的需求。

---

## 2. 功能需求

### 2.1 文件处理

#### 2.1.1 图片导入
- **拖拽导入**：支持将单张图片文件拖拽到应用窗口内进行导入。
- **文件选择器**：提供“选择图片”按钮，允许用户通过系统文件浏览器选择一张或多张图片。
- **文件夹导入**：提供“选择文件夹”按钮，导入指定文件夹内的所有支持格式的图片。
- **图片列表**：在界面侧边栏或底部显示已导入图片的列表，包含缩略图和文件名，方便用户切换和管理。

#### 2.1.2 格式支持
- **输入格式**：
  - **必须支持**：JPEG, PNG。
  - **强烈建议**：BMP, TIFF。
  - **特别要求**：PNG 格式必须完整支持其透明通道。
- **输出格式**：
  - 用户可选择将添加水印后的图片导出为 JPEG 或 PNG 格式。

#### 2.1.3 图片导出
- **输出路径**：用户可指定一个用于存放导出图片的文件夹。为防止意外覆盖原始文件，禁止将图片导出到原始文件夹。
- **命名规则**：提供以下文件命名选项：
  - **保留原文件名**：导出的文件名与原文件相同。
  - **添加前缀**：用户可自定义前缀（如 `wm_`），导出文件名为 `[前缀][原文件名]`。
  - **添加后缀**：用户可自定义后缀（如 `_watermarked`），导出文件名为 `[原文件名][后缀]`。
- **JPEG 质量（可选）**：
  - 若输出格式为 JPEG，提供一个从 0 到 100 的滑块，用于调节图片的压缩质量。
- **图片尺寸调整（可选）**：
  - 在导出时，允许用户选择是否调整输出图片的尺寸，提供以下方式：
    - 按宽度缩放（等比）。
    - 按高度缩放（等比）。
    - 按百分比缩放。

---

### 2.2 水印类型

#### 2.2.1 文本水印
- **内容**：提供一个输入框，允许用户自定义水印文本。
- **透明度**：提供一个滑块（0-100%），用于调节文本的透明度。
- **字体（可选）**：
  - 允许用户选择系统已安装的字体。
  - 允许设置字号、粗体、斜体。
- **颜色（可选）**：
  - 提供调色板工具，让用户选择字体颜色。
- **样式（可选）**：
  - 允许为文本添加阴影或描边效果，以增强在复杂背景下的可读性。

#### 2.2.2 图片水印（可选）
- **导入**：用户可以从本地选择一张图片（如 Logo）作为水印。
- **格式**：必须支持带透明通道的 PNG 图片作为水印。
- **缩放**：允许用户按比例或自由调整图片水印的大小。
- **透明度**：提供一个滑块（0-100%），用于调节图片水印的整体透明度。

---

### 2.3 布局与样式

#### 2.3.1 实时预览
- **主预览窗口**：界面中心区域为预览窗口，实时显示水印在当前选定图片上的效果。
- **即时反馈**：所有对水印参数（内容、位置、大小、旋转、透明度等）的调整，都应立即在预览窗口中更新。
- **图片切换**：用户点击图片列表中的不同图片时，预览窗口应切换到对应图片并应用当前的水印设置。

#### 2.3.2 位置
- **预设位置**：提供一个九宫格布局选择器（如九个按钮），用户可一键将水印放置在图片的四角、四边中点和正中心。
- **手动拖拽**：用户可以直接在预览图上通过鼠标拖拽来移动水印到任意位置。

#### 2.3.3 旋转（可选）
- 提供一个滑块或输入框，允许用户以任意角度（0-360°）旋转水印。

---

### 2.4 配置管理

#### 2.4.1 水印模板
- **保存模板**：用户可以将当前的所有水印设置（包括水印类型、内容、字体、颜色、位置、大小、透明度、旋转角度等）保存为一个具名模板。
- **管理模板**：提供加载、重命名和删除已保存模板的功能。
- **自动加载**：程序启动时，可选择自动加载上一次关闭时的设置或一个用户指定的默认模板。

---

## 3. 技术规格

- **开发语言**：Python 3.x
- **GUI 框架**：Tkinter (或其增强版如 CustomTkinter，以实现更美观的界面)
- **图像处理库**：Pillow (PIL Fork)
- **打包工具**：PyInstaller
- **目标平台**：macOS, Windows

---

## 4. 非功能性需求

- **性能**：界面操作应流畅，实时预览无明显卡顿。批量处理时应有进度提示。
- **易用性**：界面布局直观，功能易于理解，无需复杂学习即可上手。
- **稳定性**：应用运行稳定，能正确处理异常（如不支持的文件格式、文件读取失败等）。
- **兼容性**：在主流 macOS 和 Windows 版本上均能正常运行。

---
## 5. 发布计划
- **最终交付物**：一个在 macOS 上可直接双击运行的 `.app` 文件，并作为 GitHub Release 发布。
